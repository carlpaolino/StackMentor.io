#!/bin/bash

echo "ğŸš€ Setting up StackMentor.io..."

# Check if Node.js is installed
if ! command -v node &> /dev/null; then
    echo "âŒ Node.js is not installed. Please install Node.js 18+ first."
    echo "Download from: https://nodejs.org/"
    exit 1
fi

# Check Node.js version
NODE_VERSION=$(node -v | cut -d'v' -f2 | cut -d'.' -f1)
if [ "$NODE_VERSION" -lt 18 ]; then
    echo "âŒ Node.js version 18+ is required. Current version: $(node -v)"
    exit 1
fi

echo "âœ… Node.js version: $(node -v)"

# Check if pnpm is installed
if ! command -v pnpm &> /dev/null; then
    echo "ğŸ“¦ Installing pnpm..."
    npm install -g pnpm
fi

echo "âœ… pnpm version: $(pnpm --version)"

# Install dependencies
echo "ğŸ“¦ Installing dependencies..."
pnpm install

# Create .env file if it doesn't exist
if [ ! -f .env ]; then
    echo "ğŸ”§ Creating .env file..."
    cp env.example .env
    echo "âœ… .env file created. Please edit it and add your OpenAI API key."
else
    echo "âœ… .env file already exists."
fi

# Create necessary directories
echo "ğŸ“ Creating directories..."
mkdir -p dist
mkdir -p release

echo ""
echo "ğŸ‰ Setup complete!"
echo ""
echo "Next steps:"
echo "1. Edit .env file and add your OpenAI API key"
echo "2. Run 'pnpm dev' to start the development server"
echo "3. Run 'pnpm electron:dev' in another terminal to start the Electron app"
echo ""
echo "For more information, see SETUP.md" 